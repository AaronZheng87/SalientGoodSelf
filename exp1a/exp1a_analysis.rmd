---
title: "Analyizing the Behavioral Data of Experimental 1"
author: "Chuan-Peng Hu"
date: "Sunday, Feb 18, 2018"
output: word_document
---

<style type="text/css">

body{ /* Normal  */
   font-family: Times     
   font-size: 12px;
}
td {  /* Table  */
   font-size: 8px;
}
h1 { /* Header 1 */
 font-size: 28px;
}
h2 { /* Header 2 */
 font-size: 22px;
}
h3 { /* Header 3 */
 font-size: 18px;
 color: DarkBlue;
}
code.r{ /* Code block */
  font-size: 10px;
}
pre { /* Code block */
  font-size: 10px
}
</style>


This script is 

```{r Initializing, include=FALSE}
source('Initial.r')
```

# Experiment 1a 

```{r loadingDatadf1a,echo=FALSE,results='hide'}
# load the preprocessed data (long-format) 
df1a_d  <- read.csv("exp1a_dprime_long.csv",header = TRUE, sep = ",",stringsAsFactors=FALSE,na.strings=c("","NA"))
df1a_rt <- read.csv("exp1a_rt_acc_long.csv",header = TRUE, sep = ",",stringsAsFactors=FALSE,na.strings=c("","NA"))

# read the preprocessed data (wide-format)
df1a_w <- read.csv("exp1a_behav_wide.csv",header = TRUE, sep = ",",stringsAsFactors=FALSE,na.strings=c("","NA"))

```

## Participants
57 college students were recruited (38 female, age = 20.75 ± 2.54 years. 39 college students were from Tsinghua University community in 2014; 18 additional college students were recruited at Wenzhou University in 2017. The additional data were collected to get at least 50 participants as suggestion by Simmons, Nelson, and Simonsohn (2013)). All participants were right-handed except one, and all had normal or corrected-to-normal vision. Informed consent was obtained from all participants prior to the experiment according to procedures approved by a local ethics committee. 6 participant’s data was excluded from analysis because nearly random level of accuracy (4 participants from the Tsinghua community and 2 from the Wenzhou community), leaving 51 participants (34 female, age = 20.72 ± 2.44 years).

##Results
Correct responses shorter than 200 ms were excluded from the analysis, eliminated 0.04% of the trials overall. Table 1 shows the accuracy and Reaction times(RTs) of paired trials in Experiment 1. 

###Analaysis of d prime
```{r analyzing d prime df1a, echo=FALSE, results='hide',warning=FALSE, message=FALSE}
# RM-anova for d prime
df1a.d_anova1 <- ezANOVA(df1a_d,dv = dprime, wid = Subject, within=.(Morality), type=3)
print(df1a.d_anova1)

# t-test
# moral vs immoral
df1a.d.mrl_imm <- t.test(df1a_w$d_Moral,df1a_w$d_Immoral,paired = TRUE)
df1a_w$d_mrl_imm <- df1a_w$d_Moral - df1a_w$d_Immoral
df1a.d.mrl_imm.CI <- bootES(df1a_w$d_mrl_imm,R = 20000, effect.type = "cohens.d")

df1a.d.tvalue.mrl_imm <- round(as.numeric(df1a.d.mrl_imm[[1]]),3)
df1a.d.df1a.d.mrl_imm <- as.numeric(df1a.d.mrl_imm[[2]])
df1a.d.pvalue.mrl_imm.adj <- p.adjust(as.numeric(df1a.d.mrl_imm[[3]],"bonferroni",3))
df1a.d.cohens.mrl_imm <- round(df1a.d.mrl_imm.CI[[1]],4) 
df1a.d.CI.L.mrl_imm <- round(df1a.d.mrl_imm.CI[[12]][1],4)
df1a.d.CI.H.mrl_imm <- round(df1a.d.mrl_imm.CI[[12]][2],4)

# moral vs Average
df1a.d.mrl_ave <- t.test(df1a_w$d_Moral,df1a_w$d_Neutral,paired = TRUE)
df1a_w$mrl_ave <- df1a_w$d_Moral - df1a_w$d_Neutral
df1a.d.mrl_ave.CI <- bootES(df1a_w$mrl_ave,R = 20000, effect.type = "cohens.d")

df1a.d.tvalue.mrl_ave  <- round(as.numeric(df1a.d.mrl_ave[[1]]),3)
df1a.d.df1a.mrl_ave  <- as.numeric(df1a.d.mrl_ave[[2]])
df1a.d.pvalue.mrl_ave.adj <- p.adjust(as.numeric(df1a.d.mrl_ave[[3]],"bonferroni",3))
df1a.d.cohens.mrl_ave <- round(df1a.d.mrl_ave.CI[[1]],4) 
df1a.d.CI.L.mrl_ave <- round(df1a.d.mrl_ave.CI[[12]][1],4)
df1a.d.CI.H.mrl_ave <- round(df1a.d.mrl_ave.CI[[12]][2],4)

# Immoral vs. Average
df1a.d.imm_ave <- t.test(df1a_w$d_Immoral,df1a_w$d_Neutral,paired = TRUE)
df1a_w$imm_ave <- df1a_w$d_Immoral - df1a_w$d_Neutral
df1a.d.imm_ave.CI <- bootES(df1a_w$imm_ave,R = 20000, effect.type = "cohens.d")

df1a.d.tvalue.imm_ave <- round(as.numeric(df1a.d.imm_ave[[1]]),3)
df1a.d.df1a.imm_ave <- as.numeric(df1a.d.imm_ave[[2]])
df1a.d.pvalue.imm_ave.adj <- p.adjust(as.numeric(df1a.d.imm_ave[[3]],"bonferroni",3))
df1a.d.cohens.imm_ave <- round(df1a.d.imm_ave.CI[[1]],4) 
df1a.d.CI.L.imm_ave <- round(df1a.d.imm_ave.CI[[12]][1],4)
df1a.d.CI.H.imm_ave <- round(df1a.d.imm_ave.CI[[12]][2],4)


## plot and save the results of d'
df1a.V.SDT.sum <- summarySE(df1a_d,measurevar = 'dprime',groupvars = c('Morality'))
df1a.d.mean.ml <- round(df1a.V.SDT.sum$dprime[df1a.V.SDT.sum$Morality == 'Moral'],2)
df1a.d.sd.ml   <- round(df1a.V.SDT.sum$sd    [df1a.V.SDT.sum$Morality == 'Moral'],2)
df1a.d.mean.im <- round(df1a.V.SDT.sum$dprime[df1a.V.SDT.sum$Morality == 'Immoral'],2)
df1a.d.sd.im   <- round(df1a.V.SDT.sum$sd    [df1a.V.SDT.sum$Morality == 'Immoral'],2)
df1a.d.mean.av <- round(df1a.V.SDT.sum$dprime[df1a.V.SDT.sum$Morality == 'Neutral'],2)
df1a.d.sd.av   <- round(df1a.V.SDT.sum$sd    [df1a.V.SDT.sum$Morality == 'Neutral'],2)

df1a.V.SDT.sum$Morality <- factor(df1a.V.SDT.sum$Morality,levels = c('Moral','Neutral','Immoral'))

df1a.p_dprime <-ggplot(data = df1a.V.SDT.sum,aes(y = dprime, x = Morality, group = Morality,shape = Morality, fill = Morality)) +
        geom_bar(position = position_dodge(),stat = "identity",colour = "black", size=.3, width = 0.6) +         # Thinner lines
        geom_errorbar(aes(ymin = dprime - se, ymax = dprime + se),
                      #geom_errorbar(aes(ymin = 1, ymax = 4),
                      size = 1,
                      width = 0.2,
                      lwd = 1,
                      position=position_dodge(.6)) +
        labs(x = 'Moral valence',y = 'd prime') +
        #ylab(" Reaction times") + 
        #ylim(1, 4) +
        ggtitle("d prime for each condition") +
        coord_cartesian(ylim=c(1,3.5))+
        scale_y_continuous(breaks = seq(1,3.5,0.5),expand = c(0, 0)) +
        #scale_fill_grey (start=0.2, end=0.8) +   # using grey scale, start from darker, end to lighter. 
        #theme_classic()
        apatheme  +
        theme(axis.text = element_text (size = 20, color = 'black')) + 
        theme(axis.title = element_text (size = 20)) + 
        theme(plot.title = element_text(size = 20)) +
        theme(legend.text = element_text(size =20)) +
        theme(axis.title.y = element_text(margin=margin(0,20,0,0))) +  # increase the space between title and y axis
        theme(axis.title.x = element_text(margin=margin(20,0,0,0))) +   # increase the sapce betwen title and x axis
        scale_fill_manual(values=c("grey20",'grey50', "grey80"),labels=c("Moral ",'Neutral  ',"Immoral"))+
        theme(axis.line.x = element_line(color="black", size = 1),
              axis.line.y = element_line(color="black", size = 1))

# ggsave('e1_dprime_mean_plot.png', width=4, height=6, unit='in', dpi=300)  # save the plot
```

The effect of `r df1a.d_anova1[[1]][1,1]`: *F*(`r df1a.d_anova1[[1]][1,2]`, `r df1a.d_anova1[[1]][1,3]`) = `r round(df1a.d_anova1[[1]][1,4],3)`, *p* = `r round(df1a.d_anova1[[1]][1,5],4)`, $\eta_g^2$ = `r round(df1a.d_anova1[[1]][1,7],4)`

Then we conducted sample effect analysis for (see figure 1).

Moral (*d'* = `r df1a.d.mean.ml` $\pm$  `r df1a.d.sd.ml`) vs immoral  (*d'* = `r df1a.d.mean.im` $\pm$  `r df1a.d.sd.im`) association: *t*(`r df1a.d.df1a.d.mrl_imm`) = `r df1a.d.tvalue.mrl_imm`, *p* = 
`r df1a.d.pvalue.mrl_imm.adj`, *Cohen's* $d_z$ = `r df1a.d.cohens.mrl_imm`, 95% CI [`r df1a.d.CI.L.mrl_imm` `r df1a.d.CI.H.mrl_imm`]

Moral (*d'* = `r df1a.d.mean.ml` $\pm$  `r df1a.d.sd.ml`) vs. Average (*d'* = `r df1a.d.mean.av` $\pm$  `r df1a.d.sd.av`) Association: *t*(`r df1a.d.df1a.mrl_ave`) = `r df1a.d.tvalue.mrl_ave`, *p* = 
`r df1a.d.pvalue.mrl_ave.adj`, *Cohen's* $d_z$ = `r df1a.d.cohens.mrl_ave`, 95% CI [`r df1a.d.CI.L.mrl_ave` `r df1a.d.CI.H.mrl_ave`]

Immoral (*d'* = `r df1a.d.mean.im` $\pm$  `r df1a.d.sd.im`) vs. Average (*d'* = `r df1a.d.mean.av` $\pm$  `r df1a.d.sd.av`) association: *t*(`r df1a.d.df1a.imm_ave`) = `r df1a.d.tvalue.imm_ave`, *p* = 
`r df1a.d.pvalue.imm_ave.adj`, *Cohen's* $d_z$ = `r df1a.d.cohens.imm_ave`, 95% CI [`r df1a.d.CI.L.imm_ave` `r df1a.d.CI.H.imm_ave`]


```{r plot the d prime df1a, fig.width=4, fig.height=6,echo=FALSE,warning=FALSE,message=FALSE }
ggplot(data = df1a.V.SDT.sum,aes(y = dprime, x = Morality, group = Morality,shape = Morality, fill = Morality)) +
        geom_bar(position = position_dodge(),stat = "identity",colour = "black", size=.3, width = 0.6) +         # Thinner lines
        geom_errorbar(aes(ymin = dprime - se, ymax = dprime + se),
                      #geom_errorbar(aes(ymin = 1, ymax = 4),
                      size = 1,
                      width = 0.2,
                      lwd = 1,
                      position=position_dodge(.6)) +
        labs(x = 'Moral valence',y = 'd prime') +
        #ylab(" Reaction times") + 
        #ylim(1, 4) +
        ggtitle("d prime for each condition") +
        coord_cartesian(ylim=c(1,3.5))+
        scale_y_continuous(breaks = seq(1,3.5,0.5),expand = c(0, 0)) +
        #scale_fill_grey (start=0.2, end=0.8) +   # using grey scale, start from darker, end to lighter. 
        #theme_classic()
        apatheme  +
        theme(axis.text = element_text (size = 20, color = 'black')) + 
        theme(axis.title = element_text (size = 20)) + 
        theme(plot.title = element_text(size = 20)) +
        theme(legend.text = element_text(size =20)) +
        theme(axis.title.y = element_text(margin=margin(0,20,0,0))) +  # increase the space between title and y axis
        theme(axis.title.x = element_text(margin=margin(20,0,0,0))) +   # increase the sapce betwen title and x axis
        scale_fill_manual(values=c("grey20",'grey50', "grey80"),labels=c("Moral ",'Neutral  ',"Immoral"))+
        theme(axis.line.x = element_line(color="black", size = 1),
              axis.line.y = element_line(color="black", size = 1))
```

###Analaysis of reaction time
```{r analyzing RT df1a,echo=FALSE,results='hide',warning=FALSE, message=FALSE}
## plot density of each subject's RT and save them individually
subNo <- unique(df1a.V$Subject)
## doing the analysis for RT ####
df1a.V.RT <- df1a.V[df1a.V$ACC ==1,]  # exclued rt data less than 200 ms, and inaccurate data
df1a.V.RT.subj <- summarySEwithin(df1a.V.RT,measurevar = 'RT', withinvar = c('Subject','matchness','morality'), idvar = 'Subject',na.rm = TRUE)

df1a.V.RT.grand <- summarySE(df1a.V.RT.subj,measurevar = 'RT', groupvar = c('matchness','morality'),na.rm = TRUE)
df1a.V.RT_match <- df1a.V.RT[df1a.V.RT$matchness == "Match",]
df1a.V.RT_mismatch <- df1a.V.RT[df1a.V.RT$matchness == "Mismatch",]

df1a.rt_anova.match <- ezANOVA(df1a.V.RT_match,dv = RT, wid = Subject, within=.(morality),within_full=.(morality), type=3)
df1a.rt_anova.mismatch <- ezANOVA(df1a.V.RT_mismatch,dv = RT, wid = Subject, within=.(morality),within_full=.(morality), type=3)

## t-test for matched trials
df1a.V.RT.subj_w <- dcast(df1a.V.RT.subj, Subject ~ matchness + morality ,value.var = "RT") 

# moral vs. immoral
df1a.rt.t.m.mrl_imm <- t.test(df1a.V.RT.subj_w$Match_Moral,df1a.V.RT.subj_w$Match_Immoral,paired = TRUE)
df1a.V.RT.subj_w$m.mrl_imm <- df1a.V.RT.subj_w$Match_Moral - df1a.V.RT.subj_w$Match_Immoral
df1a.rt.t.m.mrl_imm.CI <- bootES(df1a.V.RT.subj_w$m.mrl_imm, R = 20000,effect.type = "cohens.d")

df1a.rt.tvalue.mrl_imm  <- round(as.numeric(df1a.rt.t.m.mrl_imm [[1]]),3)
df1a.rt.df1a.mrl_imm  <- as.numeric(df1a.rt.t.m.mrl_imm [[2]])
df1a.rt.pvalue.mrl_imm.adj <- p.adjust(as.numeric(df1a.rt.t.m.mrl_imm [[3]],"bonferroni",3))
df1a.rt.cohens.mrl_imm <- round(df1a.rt.t.m.mrl_imm.CI[[1]],4) 
df1a.rt.CI.L.mrl_imm <- round(df1a.rt.t.m.mrl_imm.CI[[12]][1],4)
df1a.rt.CI.H.mrl_imm <- round(df1a.rt.t.m.mrl_imm.CI[[12]][2],4)

# moral vs. average
df1a.rt.t.m.mrl_ave <- t.test(df1a.V.RT.subj_w$Match_Moral,df1a.V.RT.subj_w$Match_Average,paired = TRUE)
df1a.V.RT.subj_w$m.mrl_ave <- df1a.V.RT.subj_w$Match_Moral - df1a.V.RT.subj_w$Match_Average
df1a.rt.t.m.mrl_ave.CI <- bootES(df1a.V.RT.subj_w$m.mrl_ave, R = 20000,effect.type = "cohens.d")

df1a.rt.tvalue.mrl_ave <- round(as.numeric(df1a.rt.t.m.mrl_ave [[1]]),3)
df1a.rt.df1a.mrl_ave <- as.numeric(df1a.rt.t.m.mrl_ave[[2]])
df1a.rt.pvalue.mrl_ave.adj <- p.adjust(as.numeric(df1a.rt.t.m.mrl_ave[[3]],"bonferroni",3))
df1a.rt.cohens.mrl_ave <- round(df1a.rt.t.m.mrl_ave.CI[[1]],4) 
df1a.rt.CI.L.mrl_ave <- round(df1a.rt.t.m.mrl_ave.CI[[12]][1],4)
df1a.rt.CI.H.mrl_ave <- round(df1a.rt.t.m.mrl_ave.CI[[12]][2],4)

# immoral vs. average
df1a.rt.t.m.imm_ave <- t.test(df1a.V.RT.subj_w$Match_Immoral,df1a.V.RT.subj_w$Match_Average,paired = TRUE)
df1a.V.RT.subj_w$m.imm_ave <- df1a.V.RT.subj_w$Match_Immoral - df1a.V.RT.subj_w$Match_Average
df1a.rt.t.m.imm_ave.CI <- bootES(df1a.V.RT.subj_w$m.imm_ave, R = 20000,effect.type = "cohens.d")

df1a.rt.tvalue.imm_ave <- round(as.numeric(df1a.rt.t.m.imm_ave[[1]]),3)
df1a.rt.df1a.imm_ave  <- as.numeric(df1a.rt.t.m.imm_ave[[2]])
df1a.rt.pvalue.imm_ave.adj <- p.adjust(as.numeric(df1a.rt.t.m.imm_ave[[3]],"bonferroni",3))
df1a.rt.cohens.imm_ave <- round(df1a.rt.t.m.imm_ave.CI [[1]],4) 
df1a.rt.CI.L.imm_ave <- round(df1a.rt.t.m.imm_ave.CI[[12]][1],4)
df1a.rt.CI.H.imm_ave <- round(df1a.rt.t.m.imm_ave.CI[[12]][2],4)

df1a.V.RT.grand.match <- df1a.V.RT.grand[df1a.V.RT.grand$matchness == "Match",]
df1a.rt.mean.ml <- round(df1a.V.RT.grand.match$RT[df1a.V.RT.grand.match$morality == 'Moral'],0)
df1a.rt.sd.ml <- round(df1a.V.RT.grand.match$sd[df1a.V.RT.grand.match$morality == 'Moral'],0)
df1a.rt.mean.im <- round(df1a.V.RT.grand.match$RT[df1a.V.RT.grand.match$morality == 'Immoral'],0)
df1a.rt.sd.im <- round(df1a.V.RT.grand.match$sd[df1a.V.RT.grand.match$morality == 'Immoral'],0)
df1a.rt.mean.av <- round(df1a.V.RT.grand.match$RT[df1a.V.RT.grand.match$morality == 'Average'],0)
df1a.rt.sd.av <- round(df1a.V.RT.grand.match$sd[df1a.V.RT.grand.match$morality == 'Average'],0)

df1a.p_rt <- ggplot(data = df1a.V.RT.grand.match, aes(x=morality,y=RT,group=morality,shape = morality,fill = morality)) +
        geom_bar(position = position_dodge(),stat = "identity",colour = "black", size=.3, width = 0.6) +         # Thinner lines
        geom_errorbar(aes(ymin = RT-se, ymax = RT + se),
                      size = .3,
                      width = .2,
                      position=position_dodge(.6)) +
        labs(y = 'Reaction times (ms)') +
        coord_cartesian(ylim=c(500,800))+
        scale_y_continuous(breaks = seq(500,800,50),expand = c(0, 0)) +
        scale_fill_grey (start=0.2, end=0.8) +   # using grey scale, start from darker, end to lighter.
        #ylim(0.3, 0.8) +
        ggtitle("RT for each condition") +
        #scale_y_continuous("Reation Times  (ms)",expand = c(0, 0)) + 
        apatheme +
        theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
# ggsave('e1_RT_mean_plot.png', width=4, height=6, unit='in', dpi=300)  # save the plot

tiff(filename = "Figure 1a. d prime and RTs of Experiment 1a.tiff", width = 8, height = 6, units = 'in', res = 300)
multiplot(df1a.p_dprime,df1a.p_rt,cols = 2)
dev.off()

```

We conducted two repeated measure ANOVA for RT of matched trials and mismatched trials separately
For the matched trials, 
The effect of `r df1a.rt_anova.match[[1]][1,1]`: *F*(`r df1a.rt_anova.match[[1]][1,2]`, `r df1a.rt_anova.match[[1]][1,3]`) = `r round(df1a.rt_anova.match[[1]][1,4],3)`, *p* = `r round(df1a.rt_anova.match[[1]][1,5],4)`, $\eta_g^2$ = `r round(df1a.rt_anova.match[[1]][1,7],4)`

For the nonmatched trials, 
The effect of `r df1a.rt_anova.mismatch[[1]][1,1]`: *F*(`r df1a.rt_anova.mismatch[[1]][1,2]`, `r df1a.rt_anova.mismatch[[1]][1,3]`) = `r round(df1a.rt_anova.mismatch[[1]][1,4],3)`, *p* = `r round(df1a.rt_anova.mismatch[[1]][1,5],4)`, $\eta_g^2$ = `r round(df1a.rt_anova.mismatch[[1]][1,7],4)`

Then we conducted sample effect analysis for the matched trials.

Moral (RT = `r df1a.rt.mean.ml` $\pm$ `r df1a.rt.sd.ml`) vs immoral (RT = `r df1a.rt.mean.im` $\pm$ `r df1a.rt.sd.im`) association : *t*(`r df1a.rt.df1a.mrl_imm`) = `r df1a.rt.tvalue.mrl_imm`, *p* = `r df1a.rt.pvalue.mrl_imm.adj`, *Cohen's* $d_z$ = `r df1a.rt.cohens.mrl_imm`, 95% CI [`r df1a.rt.CI.L.mrl_imm` `r df1a.rt.CI.H.mrl_imm`]

Moral (RT = `r df1a.rt.mean.ml` $\pm$ `r df1a.rt.sd.ml`) vs. average  (RT = `r df1a.rt.mean.av` $\pm$ `r df1a.rt.sd.av`) association: *t*(`r df1a.rt.df1a.mrl_ave`) = `r df1a.rt.tvalue.mrl_ave`, *p* = `r df1a.rt.pvalue.mrl_ave.adj`, *Cohen's* $d_z$ = `r df1a.rt.cohens.mrl_ave`, 95% CI [`r df1a.rt.CI.L.mrl_ave` `r df1a.rt.CI.H.mrl_ave`]

Immoral (RT = `r df1a.rt.mean.im` $\pm$ `r df1a.rt.sd.im`) vs. average (RT = `r df1a.rt.mean.av` $\pm$ `r df1a.rt.sd.av`) association: *t*(`r df1a.rt.df1a.imm_ave`) = `r df1a.rt.tvalue.imm_ave`, *p* = `r df1a.rt.pvalue.imm_ave.adj`, *Cohen's* $d_z$ = `r df1a.rt.cohens.imm_ave`, 95% CI [`r df1a.rt.CI.L.imm_ave` `r df1a.rt.CI.H.imm_ave`]


```{r plot the RT1 df1a, fig.width=4, fig.height=6,echo=FALSE,warning=FALSE,message=FALSE }
# df1a.V.RT.grand.match <- df1a.V.RT.grand[df1a.V.RT.grand$matchness == "match",]
ggplot(data = df1a.V.RT.grand.match, aes(x=morality,y=RT,group=morality,shape = morality,fill = morality)) +
        geom_bar(position = position_dodge(),stat = "identity",colour = "black", size=.3, width = 0.6) +         # Thinner lines
        geom_errorbar(aes(ymin = RT-se, ymax = RT + se),
                      size = .3,
                      width = .2,
                      position=position_dodge(.6)) +
        labs(x = 'Moral valence',y = 'Reaction times (ms)') +
        coord_cartesian(ylim=c(500,800))+
        scale_y_continuous(breaks = seq(500,800,50),expand = c(0, 0)) +
        scale_fill_grey (start=0.2, end=0.8) +   # using grey scale, start from darker, end to lighter.
        #ylim(0.3, 0.8) +
        ggtitle("RT for each condition") +
        #scale_y_continuous("Reation Times  (ms)",expand = c(0, 0)) + 
        apatheme +
        theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())

```

The above is the reaction time for each condition


# Experiment 1b
```{r loadingData_e1b,echo=FALSE,results='hide'}
df1b <- read.csv("rawdata_exp_behav_moral_asso_1b.csv",header = TRUE, sep = ",",stringsAsFactors=FALSE,na.strings=c("","NA"))

# rename colnames
colnames(df1b)[colnames(df1b)=="Target.ACC"] <- "ACC"
colnames(df1b)[colnames(df1b)=="Target.RT"] <- "RT"
colnames(df1b)[colnames(df1b)=="YesNoResp"] <- "matchness"
colnames(df1b)[colnames(df1b)=="Shape"] <- "morality"

# renames independent variables
df1b$morality[df1b$morality == "Good"] <- "Moral"
df1b$morality[df1b$morality == "Normal"] <- "Average"
df1b$morality[df1b$morality == "Bad"] <- "Immoral"
df1b$morality <- factor(df1b$morality, levels=c("Moral", "Average","Immoral")) # make the variables in a specified order
# df$Identity <- factor(df$Identity, levels=c("Self", "Other"))
df1b$matchness[df1b$matchness == "Yes"] <- "Match"
df1b$matchness[df1b$matchness == "No"] <- "Mismatch"
df1b$matchness <- factor(df1b$matchness, levels=c("Match", "Mismatch"))

```

```{r clean_the_data_e1b,echo=FALSE,results='hide',warning=FALSE, message=FALSE}
## Basic information of the data ####
df1b.T.basic <- df1b[!duplicated(df1b$Subject), 1:4]
e1b.num.subj <- nrow(df1b.T.basic)
e1b.numT.female <- sum(df1b.T.basic$Sex == 'female');
e1b.numT.male <- sum(df1b.T.basic$Sex == 'male');
e1b.ageT.mean <- round(mean(df1b.T.basic$Age),2);
e1b.ageT.std <- round(sd(df1b.T.basic$Age),2);

# data from foreign students were excluded because their may not familar with Chinese Character
#foreignStdID <- c(24,29,30,33)
#nforeign <- length(foreignStdID)
#df1b <- df1b[!(df1b$Subject %in% foreignStdID),]

df1b.P <- df1b[is.na(df1b$BlockList.Sample),]            # data from practice
df1b.T <- df1b[complete.cases(df1b$BlockList.Sample),]   # data from test
# trials that should be excluded from analysis because of less than 200 ms
# note that this should be reconsidered when doinng DDM analysis
# and also the trials without response
e1b.excld.trials <- df1b.T[df1b.T$RT <= 200,]
e1b.ratio.excld.trials <- nrow(e1b.excld.trials)/nrow(df1b.T) # ratio of excluded trials in all triasl.
# caculate the overall accuracy for each subject
df1b.acc.g <-  ddply(df1b.T,.(Subject), summarise,
                      N = length(ACC),
                      countN = sum(ACC),
                      ACC = sum(ACC)/length(ACC))
e1b.excld.sub <- df1b.acc.g$Subject[df1b.acc.g$ACC < 0.6]
df1b.valid <- df1b.T[!(df1b.T$Subject %in% e1b.excld.sub),] # exclude the invalid subjects
length(unique(df1b.valid$Subject)) + length(e1b.excld.sub) == length(unique(df1b$Subject))
# excld.trials3 <- excld.trials[!(excld.trials$Subject %in% excld.sub),]
e1b.excld.trials2 <- df1b.valid[df1b.valid$RT <= 200,]
df1b.V <- df1b.valid[!(df1b.valid$RT <= 200),]  

## Basic information of the data ####
e1b.num.excld.sub <- length(unique(e1b.excld.sub))
df1b.V.basic <- df1b.V[!duplicated(df1b.V$Subject), 1:4]
e1b.numV.female <- sum(df1b.V.basic$Sex == 'female');
e1b.numV.male <- sum(df1b.V.basic$Sex == 'male');
e1b.ageV.mean <- round(mean(df1b.V.basic$Age),2);
e1b.ageV.std <- round(sd(df1b.V.basic$Age),2);
e1b.ratio.excld.trials2 <- nrow(e1b.excld.trials2)/nrow(df1b.valid)
```

## Participants
`r e1b.num.subj` participants were recruited from local university (`r e1b.numT.female` female, age: `r e1b.ageT.mean` $\pm$ `r e1b.ageT.std`), all participants had normal vision or corrected-to-normal vision and right handed. Also, data from `r e1b.num.excld.sub` participants were excluded from analysis due to less than 60% overall accuracy, leaving `r nrow(df1b.V.basic)` participants (`r e1b.numV.female` female, age: `r e1b.ageV.mean` $\pm$ `r e1b.ageV.std` years).

##Results
Correct responses shorter than 200 ms were excluded from the analysis, eliminated `r  paste0(formatC(100 * round(e1b.ratio.excld.trials2,3)), "%")` of the trials overall. Table 1 shows the accuracy and Reaction times(RTs) of paired trials in Experiment 1. 

###Analaysis of d prime
```{r analyzing d prime e1b, echo=FALSE, results='hide',warning=FALSE, message=FALSE}

df1b.V$sdt <- NA
for (i in 1:nrow(df1b.V)){
        if (df1b.V$Target.RESP[i] == df1b.V$Target.CRESP[i] & df1b.V$matchness[i] == "Match"){
                df1b.V$sdt[i] <- "hit"
        } else if (df1b.V$Target.RESP[i] == df1b.V$Target.CRESP[i] & df1b.V$matchness[i] == "Mismatch"){
                df1b.V$sdt[i] <- "CR"
        } else if (df1b.V$Target.RESP[i] != df1b.V$Target.CRESP[i] & df1b.V$matchness[i] == "Match"){
                df1b.V$sdt[i] <- "miss"
        } else if (df1b.V$Target.RESP[i] != df1b.V$Target.CRESP[i] & df1b.V$matchness[i] == "Mismatch"){
                df1b.V$sdt[i] <- "FA"
        }
}

# calculate the number of each for each condition
df1b.V.SDT <-  ddply(df1b.V,.(Subject,morality,sdt), summarise,
                   N = length(sdt))

# long format to wide
df1b.V.SDT_w <- dcast(df1b.V.SDT, Subject + morality  ~ sdt,value.var = "N")
df1b.V.SDT_w$miss[is.na(df1b.V.SDT_w$miss)] <- 0
df1b.V.SDT_w$FA[is.na(df1b.V.SDT_w$FA)] <- 0
df1b.V.SDT_w$hitR <- df1b.V.SDT_w$hit/(df1b.V.SDT_w$hit + df1b.V.SDT_w$miss)
df1b.V.SDT_w$faR <- df1b.V.SDT_w$FA/(df1b.V.SDT_w$FA + df1b.V.SDT_w$CR)

# standardized way to deal with the extreme values
for (i in 1:nrow(df1b.V.SDT_w)){
        if (df1b.V.SDT_w$hitR[i] == 1){
                df1b.V.SDT_w$hitR[i] <- 1 - 1/(2*(df1b.V.SDT_w$hit[i] + df1b.V.SDT_w$miss[i]))
        }
}

for (i in 1:nrow(df1b.V.SDT_w)){
        if (df1b.V.SDT_w$faR[i] == 0){
                df1b.V.SDT_w$faR[i] <- 1/(2*(df1b.V.SDT_w$FA[i] + df1b.V.SDT_w$CR[i]))
        }
}

# calculate the d prime for each condition
df1b.V.SDT_w$dprime <- mapply(dprime,df1b.V.SDT_w$hitR,df1b.V.SDT_w$faR)

# anova for d prime with 2*2 design
e1b.d_anova1 <- ezANOVA(df1b.V.SDT_w,dv = dprime, wid = Subject, within=.(morality), type=3)
print(e1b.d_anova1)

df1b.V.SDT_ww <- dcast(df1b.V.SDT_w, Subject ~ morality ,value.var = "dprime")

# t-test
# moral vs immoral
e1b.d.tmrl_imm <- t.test(df1b.V.SDT_ww$Moral,df1b.V.SDT_ww$Immoral,paired = TRUE)
df1b.V.SDT_ww$mrl_imm <- df1b.V.SDT_ww$Moral - df1b.V.SDT_ww$Immoral
d.mrl_imm.CI <- bootES(df1b.V.SDT_ww$mrl_imm,R = 20000, effect.type = "cohens.d")

e1b.d.tvalue.mrl_imm <- round(as.numeric(e1b.d.tmrl_imm[[1]]),3)
e1b.d.df1b.d.mrl_imm <- as.numeric(e1b.d.tmrl_imm[[2]])
e1b.d.pvalue.mrl_imm.adj <- p.adjust(as.numeric(e1b.d.tmrl_imm[[3]],"bonferroni",3))
e1b.d.cohens.mrl_imm <- round(d.mrl_imm.CI[[1]],4) 
e1b.d.CI.L.mrl_imm <- round(d.mrl_imm.CI[[12]][1],4)
e1b.d.CI.H.mrl_imm <- round(d.mrl_imm.CI[[12]][2],4)

# moral vs Average
e1b.d.tmrl_ave <- t.test(df1b.V.SDT_ww$Moral,df1b.V.SDT_ww$Average,paired = TRUE)
df1b.V.SDT_ww$mrl_ave <- df1b.V.SDT_ww$Moral - df1b.V.SDT_ww$Average
e1b.d.mrl_ave.CI <- bootES(df1b.V.SDT_ww$mrl_ave,R = 20000, effect.type = "cohens.d")

e1b.d.tvalue.mrl_ave  <- round(as.numeric(e1b.d.tmrl_ave[[1]]),3)
e1b.d.df1b.mrl_ave  <- as.numeric(e1b.d.tmrl_ave[[2]])
e1b.d.pvalue.mrl_ave.adj <- p.adjust(as.numeric(e1b.d.tmrl_ave[[3]],"bonferroni",3))
e1b.d.cohens.mrl_ave <- round(e1b.d.mrl_ave.CI[[1]],4) 
e1b.d.CI.L.mrl_ave <- round(e1b.d.mrl_ave.CI[[12]][1],4)
e1b.d.CI.H.mrl_ave <- round(e1b.d.mrl_ave.CI[[12]][2],4)

# Immoral vs. Average
e1b.d.timm_ave <- t.test(df1b.V.SDT_ww$Immoral,df1b.V.SDT_ww$Average,paired = TRUE)
df1b.V.SDT_ww$imm_ave <- df1b.V.SDT_ww$Immoral - df1b.V.SDT_ww$Average
e1b.d.imm_ave.CI <- bootES(df1b.V.SDT_ww$imm_ave,R = 20000, effect.type = "cohens.d")

e1b.d.tvalue.imm_ave <- round(as.numeric(e1b.d.timm_ave[[1]]),3)
e1b.d.df1b.imm_ave <- as.numeric(e1b.d.timm_ave[[2]])
e1b.d.pvalue.imm_ave.adj <- p.adjust(as.numeric(e1b.d.timm_ave[[3]],"bonferroni",3))
e1b.d.cohens.imm_ave <- round(e1b.d.imm_ave.CI[[1]],4) 
e1b.d.CI.L.imm_ave <- round(e1b.d.imm_ave.CI[[12]][1],4)
e1b.d.CI.H.imm_ave <- round(e1b.d.imm_ave.CI[[12]][2],4)


## plot and save the results of d'
df1b.V.SDT.sum <- summarySE(df1b.V.SDT_w,measurevar = 'dprime',groupvars = c('morality'))
e1b.d.mean.ml <- round(df1b.V.SDT.sum$dprime[df1b.V.SDT.sum$morality == 'Moral'],2)
e1b.d.sd.ml <- round(df1b.V.SDT.sum$sd[df1b.V.SDT.sum$morality == 'Moral'],2)
e1b.d.mean.im <- round(df1b.V.SDT.sum$dprime[df1b.V.SDT.sum$morality == 'Immoral'],2)
e1b.d.sd.im <- round(df1b.V.SDT.sum$sd[df1b.V.SDT.sum$morality == 'Immoral'],2)
e1b.d.mean.av <- round(df1b.V.SDT.sum$dprime[df1b.V.SDT.sum$morality == 'Average'],2)
e1b.d.sd.av <-round(df1b.V.SDT.sum$sd[df1b.V.SDT.sum$morality == 'Average'],2)

e1b.p_dprime <- ggplot(data = df1b.V.SDT.sum,aes(y = dprime, x = morality, group = morality,shape = morality, fill = morality)) +
        geom_bar(position = position_dodge(),stat = "identity",colour = "black", size=.3, width = 0.6) +         # Thinner lines
        geom_errorbar(aes(ymin = dprime - se, ymax = dprime + se),
        #geom_errorbar(aes(ymin = 1, ymax = 4),
                      size = .3,
                      width = .2,
                      position=position_dodge(.6)) +
        labs(x = 'Moral valence',y = 'd prime') +
        #ylab(" Reaction times") + 
        #ylim(1, 4) +
        ggtitle("d prime for each condition") +
        coord_cartesian(ylim=c(1,3.5))+
        scale_y_continuous(breaks = seq(1,3.5,0.5),expand = c(0, 0)) +
        scale_fill_grey (start=0.2, end=0.8) +   # using grey scale, start from darker, end to lighter. 
        #theme_classic()
        apatheme  +
        theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())

# ggsave('e1_dprime_mean_plot.png', width=4, height=6, unit='in', dpi=300)  # save the plot
```

The effect of `r e1b.d_anova1[[1]][1,1]`: *F*(`r e1b.d_anova1[[1]][1,2]`, `r e1b.d_anova1[[1]][1,3]`) = `r round(e1b.d_anova1[[1]][1,4],3)`, *p* = `r round(e1b.d_anova1[[1]][1,5],4)`, $\eta_g^2$ = `r round(e1b.d_anova1[[1]][1,7],4)`

Then we conducted sample effect analysis for (see figure 1).

Moral (*d'* = `r e1b.d.mean.ml` $\pm$  `r e1b.d.sd.ml`) vs immoral  (*d'* = `r e1b.d.mean.im` $\pm$  `r e1b.d.sd.im`) association: *t*(`r e1b.d.df1b.d.mrl_imm`) = `r e1b.d.tvalue.mrl_imm`, *p* = 
`r e1b.d.pvalue.mrl_imm.adj`, *Cohen's* $d_z$ = `r e1b.d.cohens.mrl_imm`, 95% CI [`r e1b.d.CI.L.mrl_imm` `r e1b.d.CI.H.mrl_imm`]

Moral (*d'* = `r e1b.d.mean.ml` $\pm$  `r e1b.d.sd.ml`) vs. Average (*d'* = `r e1b.d.mean.av` $\pm$  `r e1b.d.sd.av`) Association: *t*(`r e1b.d.df1b.mrl_ave`) = `r e1b.d.tvalue.mrl_ave`, *p* = 
`r e1b.d.pvalue.mrl_ave.adj`, *Cohen's* $d_z$ = `r e1b.d.cohens.mrl_ave`, 95% CI [`r e1b.d.CI.L.mrl_ave` `r e1b.d.CI.H.mrl_ave`]

Immoral  (*d'* = `r e1b.d.mean.im` $\pm$  `r e1b.d.sd.im`) vs. Average (*d'* = `r e1b.d.mean.av` $\pm$  `r e1b.d.sd.av`) association: *t*(`r e1b.d.df1b.imm_ave`) = `r e1b.d.tvalue.imm_ave`, *p* = 
`r e1b.d.pvalue.imm_ave.adj`, *Cohen's* $d_z$ = `r e1b.d.cohens.imm_ave`, 95% CI [`r e1b.d.CI.L.imm_ave` `r e1b.d.CI.H.imm_ave`]


```{r plot the d prime e1b, fig.width=4, fig.height=6,echo=FALSE,warning=FALSE,message=FALSE }
ggplot(data = df1b.V.SDT.sum,aes(y = dprime, x = morality, group = morality,shape = morality, fill = morality)) +
        geom_bar(position = position_dodge(),stat = "identity",colour = "black", size=.3, width = 0.6) +         # Thinner lines
        geom_errorbar(aes(ymin = dprime - se, ymax = dprime + se),
        #geom_errorbar(aes(ymin = 1, ymax = 4),
                      size = .3,
                      width = .2,
                      position=position_dodge(.6)) +
        labs(x = 'Moral valence',y = 'd prime') +
        #ylab(" Reaction times") + 
        #ylim(1, 4) +
        ggtitle("d prime for each condition") +
        coord_cartesian(ylim=c(1,3.5))+
        scale_y_continuous(breaks = seq(1,3.5,0.5),expand = c(0, 0)) +
        scale_fill_grey (start=0.2, end=0.8) +   # using grey scale, start from darker, end to lighter. 
        #theme_classic()
        apatheme +
        theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

###Analaysis of reaction time
```{r analyzing RT e1b,echo=FALSE,results='hide',warning=FALSE, message=FALSE}
## plot density of each subject's RT and save them individually
#subNo <- unique(df1b.V$Subject)
## doing the analysis for RT ####
df1b.V.RT <- df1b.V[df1b.V$ACC ==1,]  # exclued rt data less than 200 ms, and inaccurate data
df1b.V.RT.subj <- summarySEwithin(df1b.V.RT,measurevar = 'RT', withinvar = c('Subject','matchness','morality'),idvar = 'Subject', na.rm = TRUE)

df1b.V.RT.grand <- summarySE(df1b.V.RT.subj,measurevar = 'RT', groupvar = c('matchness','morality'),na.rm = TRUE)
df1b.V.RT_match <- df1b.V.RT[df1b.V.RT$matchness == "Match",]
df1b.V.RT_mismatch <- df1b.V.RT[df1b.V.RT$matchness == "Mismatch",]

rt_anova.match <- ezANOVA(df1b.V.RT_match,dv = RT, wid = Subject, within=.(morality),within_full=.(morality), type=3)
rt_anova.mismatch <- ezANOVA(df1b.V.RT_mismatch,dv = RT, wid = Subject, within=.(morality),within_full=.(morality), type=3)

## t-test for matched trials
df1b.V.RT.subj_w <- dcast(df1b.V.RT.subj, Subject ~ matchness + morality ,value.var = "RT") 

# moral vs. immoral
e1b.rt.t.m.mrl_imm <- t.test(df1b.V.RT.subj_w$Match_Moral,df1b.V.RT.subj_w$Match_Immoral,paired = TRUE)
df1b.V.RT.subj_w$m.mrl_imm <- df1b.V.RT.subj_w$Match_Moral - df1b.V.RT.subj_w$Match_Immoral
e1b.rt.t.m.mrl_imm.CI <- bootES(df1b.V.RT.subj_w$m.mrl_imm, R = 20000,effect.type = "cohens.d")

e1b.rt.tvalue.mrl_imm  <- round(as.numeric(e1b.rt.t.m.mrl_imm [[1]]),3)
e1b.rt.df1b.mrl_imm  <- as.numeric(e1b.rt.t.m.mrl_imm [[2]])
e1b.rt.pvalue.mrl_imm.adj <- p.adjust(as.numeric(e1b.rt.t.m.mrl_imm [[3]],"bonferroni",3))
e1b.rt.cohens.mrl_imm <- round(e1b.rt.t.m.mrl_imm.CI[[1]],4) 
e1b.rt.CI.L.mrl_imm <- round(e1b.rt.t.m.mrl_imm.CI[[12]][1],4)
e1b.rt.CI.H.mrl_imm <- round(e1b.rt.t.m.mrl_imm.CI[[12]][2],4)

# moral vs. average
e1b.rt.t.m.mrl_ave <- t.test(df1b.V.RT.subj_w$Match_Moral,df1b.V.RT.subj_w$Match_Average,paired = TRUE)
df1b.V.RT.subj_w$m.mrl_ave <- df1b.V.RT.subj_w$Match_Moral - df1b.V.RT.subj_w$Match_Average
e1b.rt.t.m.mrl_ave.CI <- bootES(df1b.V.RT.subj_w$m.mrl_ave, R = 20000,effect.type = "cohens.d")

e1b.rt.tvalue.mrl_ave <- round(as.numeric(e1b.rt.t.m.mrl_ave [[1]]),3)
e1b.rt.df1b.mrl_ave <- as.numeric(e1b.rt.t.m.mrl_ave[[2]])
e1b.rt.pvalue.mrl_ave.adj <- p.adjust(as.numeric(e1b.rt.t.m.mrl_ave[[3]],"bonferroni",3))
e1b.rt.cohens.mrl_ave <- round(e1b.rt.t.m.mrl_ave.CI[[1]],4) 
e1b.rt.CI.L.mrl_ave <- round(e1b.rt.t.m.mrl_ave.CI[[12]][1],4)
e1b.rt.CI.H.mrl_ave <- round(e1b.rt.t.m.mrl_ave.CI[[12]][2],4)

# immoral vs. average
e1b.rt.t.m.imm_ave <- t.test(df1b.V.RT.subj_w$Match_Immoral,df1b.V.RT.subj_w$Match_Average,paired = TRUE)
df1b.V.RT.subj_w$m.imm_ave <- df1b.V.RT.subj_w$Match_Immoral - df1b.V.RT.subj_w$Match_Average
e1b.rt.t.m.imm_ave.CI <- bootES(df1b.V.RT.subj_w$m.imm_ave, R = 20000,effect.type = "cohens.d")

e1b.rt.tvalue.imm_ave <- round(as.numeric(e1b.rt.t.m.imm_ave[[1]]),3)
e1b.rt.df1b.imm_ave  <- as.numeric(e1b.rt.t.m.imm_ave[[2]])
e1b.rt.pvalue.imm_ave.adj <- p.adjust(as.numeric(e1b.rt.t.m.imm_ave[[3]],"bonferroni",3))
e1b.rt.cohens.imm_ave <- round(e1b.rt.t.m.imm_ave.CI [[1]],4) 
e1b.rt.CI.L.imm_ave <- round(e1b.rt.t.m.imm_ave.CI[[12]][1],4)
e1b.rt.CI.H.imm_ave <- round(e1b.rt.t.m.imm_ave.CI[[12]][2],4)

df1b.V.RT.grand.match <- df1b.V.RT.grand[df1b.V.RT.grand$matchness == "Match",]
e1b.rt.mean.ml <- round(df1b.V.RT.grand.match$RT[df1b.V.RT.grand.match$morality == 'Moral'],0)
e1b.rt.sd.ml <- round(df1b.V.RT.grand.match$sd[df1b.V.RT.grand.match$morality == 'Moral'],0)
e1b.rt.mean.im <- round(df1b.V.RT.grand.match$RT[df1b.V.RT.grand.match$morality == 'Immoral'],0)
e1b.rt.sd.im <- round(df1b.V.RT.grand.match$sd[df1b.V.RT.grand.match$morality == 'Immoral'],0)
e1b.rt.mean.av <- round(df1b.V.RT.grand.match$RT[df1b.V.RT.grand.match$morality == 'Average'],0)
e1b.rt.sd.av <- round(df1b.V.RT.grand.match$sd[df1b.V.RT.grand.match$morality == 'Average'],0)

e1b.p_rt <- ggplot(data = df1b.V.RT.grand.match, aes(x=morality,y=RT,group=morality,shape = morality,fill = morality)) +
        geom_bar(position = position_dodge(),stat = "identity",colour = "black", size=.3, width = 0.6) +         # Thinner lines
        geom_errorbar(aes(ymin = RT-se, ymax = RT + se),
                      size = .3,
                      width = .2,
                      position=position_dodge(.6)) +
        labs(x = 'Moral valence',y = 'Reaction times (ms)') +
        coord_cartesian(ylim=c(500,800))+
        scale_y_continuous(breaks = seq(500,800,50),expand = c(0, 0)) +
        scale_fill_grey (start=0.2, end=0.8) +   # using grey scale, start from darker, end to lighter.
        #ylim(0.3, 0.8) +
        ggtitle("RT for each condition") +
        #scale_y_continuous("Reation Times  (ms)",expand = c(0, 0)) + 
        apatheme +
        theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
# ggsave('e1_RT_mean_plot.png', width=4, height=6, unit='in', dpi=300)  # save the plot

tiff(filename = "Figure 1b. d prime and RTs of Experiment 1b.tiff", width = 8, height = 6, units = 'in', res = 300)
multiplot(e1b.p_dprime,e1b.p_rt,cols = 2)
dev.off()

```

We conducted two repeated measure ANOVA for RT of matched trials and mismatched trials separately
For the matched trials, 
The effect of `r rt_anova.match[[1]][1,1]`: *F*(`r rt_anova.match[[1]][1,2]`, `r rt_anova.match[[1]][1,3]`) = `r round(rt_anova.match[[1]][1,4],3)`, *p* = `r round(rt_anova.match[[1]][1,5],4)`, $\eta_g^2$ = `r round(rt_anova.match[[1]][1,7],4)`

For the nonmatched trials, 
The effect of `r rt_anova.mismatch[[1]][1,1]`: *F*(`r rt_anova.mismatch[[1]][1,2]`, `r rt_anova.mismatch[[1]][1,3]`) = `r round(rt_anova.mismatch[[1]][1,4],3)`, *p* = `r round(rt_anova.mismatch[[1]][1,5],4)`, $\eta_g^2$ = `r round(rt_anova.mismatch[[1]][1,7],4)`

Then we conducted sample effect analysis for the matched trials.

Moral (RT = `r e1b.rt.mean.ml` $\pm$ `r e1b.rt.sd.ml`) vs immoral (RT = `r e1b.rt.mean.im` $\pm$ `r e1b.rt.sd.im`) association : *t*(`r e1b.rt.df1b.mrl_imm`) = `r e1b.rt.tvalue.mrl_imm`, *p* = `r e1b.rt.pvalue.mrl_imm.adj`, *Cohen's* $d_z$ = `r e1b.rt.cohens.mrl_imm`, 95% CI [`r e1b.rt.CI.L.mrl_imm` `r e1b.rt.CI.H.mrl_imm`]

Moral (RT = `r e1b.rt.mean.ml` $\pm$ `r e1b.rt.sd.ml`) vs. average  (RT = `r e1b.rt.mean.av` $\pm$ `r e1b.rt.sd.av`) association: *t*(`r e1b.rt.df1b.mrl_ave`) = `r e1b.rt.tvalue.mrl_ave`, *p* = `r e1b.rt.pvalue.mrl_ave.adj`, *Cohen's* $d_z$ = `r e1b.rt.cohens.mrl_ave`, 95% CI [`r e1b.rt.CI.L.mrl_ave` `r e1b.rt.CI.H.mrl_ave`]

Immoral (RT = `r e1b.rt.mean.im` $\pm$ `r e1b.rt.sd.im`) vs. average (RT = `r e1b.rt.mean.av` $\pm$ `r e1b.rt.sd.av`) association: *t*(`r e1b.rt.df1b.imm_ave`) = `r e1b.rt.tvalue.imm_ave`, *p* = `r e1b.rt.pvalue.imm_ave.adj`, *Cohen's* $d_z$ = `r e1b.rt.cohens.imm_ave`, 95% CI [`r e1b.rt.CI.L.imm_ave` `r e1b.rt.CI.H.imm_ave`]


```{r plot the RT1 e1b, fig.width=4, fig.height=6,echo=FALSE,warning=FALSE,message=FALSE }
# df1b.V.RT.grand.match <- df1b.V.RT.grand[df1b.V.RT.grand$matchness == "match",]
ggplot(data = df1b.V.RT.grand.match, aes(x=morality,y=RT,group=morality,shape = morality,fill = morality)) +
        geom_bar(position = position_dodge(),stat = "identity",colour = "black", size=.3, width = 0.6) +         # Thinner lines
        geom_errorbar(aes(ymin = RT-se, ymax = RT + se),
                      size = .3,
                      width = .2,
                      position=position_dodge(.6)) +
        labs(x = 'Moral valence',y = 'Reaction times (ms)') +
        coord_cartesian(ylim=c(500,800))+
        scale_y_continuous(breaks = seq(500,800,50),expand = c(0, 0)) +
        scale_fill_grey (start=0.2, end=0.8) +   # using grey scale, start from darker, end to lighter.
        #ylim(0.3, 0.8) +
        ggtitle("RT for each condition") +
        #scale_y_continuous("Reation Times  (ms)",expand = c(0, 0)) + 
        apatheme +
        theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())

```

The above is the reaction time for each condition

# combine the results of experiment 1a and 1b
```{r merging data from 1a and 1b,echo=FALSE,results='hide',warning=FALSE, message=FALSE}
# combine the d prime data
df1a.V.SDT_w$exp <- '1a';
df1b.V.SDT_w$exp <- '1b';
df1.V.SDT_w <- rbind(df1a.V.SDT_w,df1b.V.SDT_w)
```

### Analysis of d prime
```{r analyzing d prime e1,echo=FALSE,results='hide',warning=FALSE, message=FALSE}
# analysing the d prime data with experiment as variable
e1.d_anova <- ezANOVA(df1.V.SDT_w,dv = dprime, wid = Subject, within=.(morality), between = .(exp), type=3)
print(e1.d_anova)

# re-define the subject Identifier by combining the experimental no. and subject no.
df1.V.SDT_w <- within(df1.V.SDT_w,id <- paste(Subject,exp,sep = "_"))
d_anova_e1_combined <- ezANOVA(df1.V.SDT_w,dv = dprime, wid = id, within=.(morality), type=3)
print(d_anova_e1_combined)

# from long format to wide
df1.V.SDT_ww <- dcast(df1.V.SDT_w, id ~ morality ,value.var = "dprime")

# t-test
# moral vs immoral
e1.d.t.mrl_imm <- t.test(df1.V.SDT_ww$Moral,df1.V.SDT_ww$Immoral,paired = TRUE)
df1.V.SDT_ww$mrl_imm <- df1.V.SDT_ww$Moral - df1.V.SDT_ww$Immoral
e1.d.mrl_imm.CI <- bootES(df1.V.SDT_ww$mrl_imm,R = 20000, effect.type = "cohens.d")

e1.d.tvalue.mrl_imm <- round(as.numeric(e1.d.t.mrl_imm[[1]]),3)
e1.d.df.mrl_imm <- as.numeric(e1.d.t.mrl_imm[[2]])
e1.d.pvalue.mrl_imm.adj <- p.adjust(as.numeric(e1.d.t.mrl_imm[[3]],"bonferroni",3))
e1.d.cohens.mrl_imm <- round(e1.d.mrl_imm.CI[[1]],4) 
e1.d.CI.L.mrl_imm <- round(e1.d.mrl_imm.CI[[12]][1],4)
e1.d.CI.H.mrl_imm <- round(e1.d.mrl_imm.CI[[12]][2],4)

# moral vs Average
e1.d.t.mrl_ave <- t.test(df1.V.SDT_ww$Moral,df1.V.SDT_ww$Average,paired = TRUE)
df1.V.SDT_ww$mrl_ave <- df1.V.SDT_ww$Moral - df1.V.SDT_ww$Average
e1.d.mrl_ave.CI <- bootES(df1.V.SDT_ww$mrl_ave,R = 20000, effect.type = "cohens.d")

e1.d.tvalue.mrl_ave  <- round(as.numeric(e1.d.t.mrl_ave[[1]]),3)
e1.d.df1.mrl_ave  <- as.numeric(e1.d.t.mrl_ave[[2]])
e1.d.pvalue.mrl_ave.adj <- p.adjust(as.numeric(e1.d.t.mrl_ave[[3]],"bonferroni",3))
e1.d.cohens.mrl_ave <- round(e1.d.mrl_ave.CI[[1]],4) 
e1.d.CI.L.mrl_ave <- round(e1.d.mrl_ave.CI[[12]][1],4)
e1.d.CI.H.mrl_ave <- round(e1.d.mrl_ave.CI[[12]][2],4)

# Immoral vs. Average
e1.d.t.imm_ave <- t.test(df1b.V.SDT_ww$Immoral,df1b.V.SDT_ww$Average,paired = TRUE)
df1.V.SDT_ww$imm_ave <- df1.V.SDT_ww$Immoral - df1.V.SDT_ww$Average
e1.d.imm_ave.CI <- bootES(df1.V.SDT_ww$imm_ave,R = 20000, effect.type = "cohens.d")

e1.d.tvalue.imm_ave <- round(as.numeric(e1.d.t.imm_ave[[1]]),3)
e1.d.df1.imm_ave <- as.numeric(e1.d.t.imm_ave[[2]])
e1.d.pvalue.imm_ave.adj <- p.adjust(as.numeric(e1.d.t.imm_ave[[3]],"bonferroni",3))
e1.d.cohens.imm_ave <- round(e1.d.imm_ave.CI[[1]],4) 
e1.d.CI.L.imm_ave <- round(e1.d.imm_ave.CI[[12]][1],4)
e1.d.CI.H.imm_ave <- round(e1.d.imm_ave.CI[[12]][2],4)


## plot and save the results of d'
df1.V.SDT.sum <- summarySE(df1.V.SDT_w,measurevar = 'dprime',groupvars = c('morality'))
e1.d.mean.ml <- round(df1.V.SDT.sum$dprime[df1.V.SDT.sum$morality == 'Moral'],2)
e1.d.sd.ml <- round(df1.V.SDT.sum$sd[df1.V.SDT.sum$morality == 'Moral'],2)
e1.d.mean.im <- round(df1.V.SDT.sum$dprime[df1.V.SDT.sum$morality == 'Immoral'],2)
e1.d.sd.im <- round(df1.V.SDT.sum$sd[df1.V.SDT.sum$morality == 'Immoral'],2)
e1.d.mean.av <- round(df1.V.SDT.sum$dprime[df1.V.SDT.sum$morality == 'Average'],2)
e1.d.sd.av <-round(df1.V.SDT.sum$sd[df1.V.SDT.sum$morality == 'Average'],2)

e1.p_dprime <- ggplot(data = df1.V.SDT.sum,aes(y = dprime, x = morality, group = morality,shape = morality, fill = morality)) +
        geom_bar(position = position_dodge(),stat = "identity",colour = "black", size=.3, width = 0.6) +         # Thinner lines
        geom_errorbar(aes(ymin = dprime - se, ymax = dprime + se),
        #geom_errorbar(aes(ymin = 1, ymax = 4),
                      size = .3,
                      width = .2,
                      position=position_dodge(.6)) +
        labs(x = 'Moral valence',y = 'd prime') +
        #ylab(" Reaction times") + 
        #ylim(1, 4) +
        ggtitle("d prime for each condition") +
        coord_cartesian(ylim=c(1,3.5))+
        scale_y_continuous(breaks = seq(1,3.5,0.5),expand = c(0, 0)) +
        scale_fill_grey (start=0.2, end=0.8) +   # using grey scale, start from darker, end to lighter. 
        #theme_classic()
        apatheme  +
        theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```
We conducted a 2 (experiment: 1a vs. 1b) by 3 (morality: moral,immoral neutral) mixed ANOVA, with experiment as between subject variable, and the morality as within subject variable. we found that the interaction between experiment and morality was not siginalficant:  *F*(`r e1.d_anova[[1]][3,2]`, `r e1.d_anova[[1]][3,3]`) = `r round(e1.d_anova[[1]][3,4],3)`, *p* = `r round(e1.d_anova[[1]][3,5],4)`, $\eta_g^2$ = `r round(e1.d_anova[[1]][3,7],4)`. These resutls showed that the familiarity of words doesn't matter, therefore, we combined data from these two experiment.

An repeated measure ANOVA for the combined data showed a significant effect for morality : *F*(`r d_anova_e1_combined[[1]][1,2]`, `r d_anova_e1_combined[[1]][1,3]`) = `r round(d_anova_e1_combined[[1]][1,4],3)`, *p* = `r round(d_anova_e1_combined[[1]][1,5],4)`, $\eta_g^2$ = `r round(d_anova_e1_combined[[1]][1,7],4)`

Then we conducted sample effect analysis for (see figure 1).
Moral (*d'* = `r e1.d.mean.ml` $\pm$  `r e1.d.sd.ml`) vs immoral  (*d'* = `r e1.d.mean.im` $\pm$  `r e1.d.sd.im`) association: *t*(`r e1.d.df.mrl_imm`) = `r e1.d.tvalue.mrl_imm`, *p* = 
`r e1.d.pvalue.mrl_imm.adj`, *Cohen's* $d_z$ = `r e1.d.cohens.mrl_imm`, 95% CI [`r e1.d.CI.L.mrl_imm` `r e1.d.CI.H.mrl_imm`]

Moral(*d'* = `r e1.d.mean.ml` $\pm$  `r e1.d.sd.ml`) vs. Average (*d'* = `r e1.d.mean.av` $\pm$ `r e1.d.sd.av`) Association: *t*(`r e1.d.df1.mrl_ave`) = `r e1.d.tvalue.mrl_ave`, *p* = 
`r e1.d.pvalue.mrl_ave.adj`, *Cohen's* $d_z$ = `r e1.d.cohens.mrl_ave`, 95% CI [`r e1.d.CI.L.mrl_ave` `r e1.d.CI.H.mrl_ave`]

Immoral(*d'* = `r e1.d.mean.im` $\pm$  `r e1.d.sd.im`) vs. Average (*d'* = `r e1.d.mean.av` $\pm$ `r e1.d.sd.av`) association: *t*(`r e1.d.df1.imm_ave`) = `r e1.d.tvalue.imm_ave`, *p* = 
`r e1.d.pvalue.imm_ave.adj`, *Cohen's* $d_z$ = `r e1.d.cohens.imm_ave`, 95% CI [`r e1.d.CI.L.imm_ave` `r e1.d.CI.H.imm_ave`]

```{r plot the d prime e1, fig.width=4, fig.height=6,echo=FALSE,warning=FALSE,message=FALSE }
ggplot(data = df1.V.SDT.sum,aes(y = dprime, x = morality, group = morality,shape = morality, fill = morality)) +
        geom_bar(position = position_dodge(),stat = "identity",colour = "black", size=.3, width = 0.6) +         # Thinner lines
        geom_errorbar(aes(ymin = dprime - se, ymax = dprime + se),
        #geom_errorbar(aes(ymin = 1, ymax = 4),
                      size = .3,
                      width = .2,
                      position=position_dodge(.6)) +
        labs(x = 'Moral valence',y = 'd prime') +
        #ylab(" Reaction times") + 
        #ylim(1, 4) +
        ggtitle("d prime for each condition") +
        coord_cartesian(ylim=c(1,3.5))+
        scale_y_continuous(breaks = seq(1,3.5,0.5),expand = c(0, 0)) +
        scale_fill_grey (start=0.2, end=0.8) +   # using grey scale, start from darker, end to lighter. 
        #theme_classic()
        apatheme +
        theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
```

###Analaysis of reaction time
```{r analyzing RT e1,echo=FALSE,results='hide',warning=FALSE, message=FALSE}
## plot density of each subject's RT and save them individually
subNo <- unique(df1b.V$Subject)
## doing the analysis for RT ####
df1b.V.RT$exp <- '1b'   # add exp as variable
df1a.V.RT$exp <- '1a'   
df1.V.RT <- rbind(df1a.V.RT,df1b.V.RT) # combine the valide data from 1a and 1b.
df1.V.RT$id <- paste(df1.V.RT$exp,df1.V.RT$Subject,sep = "_")

df1.V.RT.subj <- summarySEwithin(df1.V.RT,measurevar = 'RT',  withinvar = c('id','matchness','morality'),idvar = 'id',na.rm = TRUE)
df1.V.RT.grand <- summarySE(df1.V.RT.subj,measurevar = 'RT',groupvar = c('matchness','morality'),na.rm = TRUE)

df1.V.RT_match <- df1.V.RT[df1.V.RT$matchness == "Match",]
df1.V.RT_mismatch <- df1.V.RT[df1.V.RT$matchness == "Mismatch",]

# test the effect of experiment
e1.rt_anova.match <- ezANOVA(df1.V.RT_match,dv = RT, wid = id, within=.(morality),within_full=.(morality), between = .(exp),type=3)

e1.rt_anova.mismatch <- ezANOVA(df1.V.RT_mismatch,dv = RT, wid = id, within=.(morality),within_full=.(morality), between = .(exp),type=3)

# test the effect of morality on the combined data
e1.rt_anova.match_all <- ezANOVA(df1.V.RT_match,dv = RT, wid = id, within=.(morality),within_full=.(morality), type=3)
e1.rt_anova.mismatch_all <- ezANOVA(df1.V.RT_mismatch,dv = RT, wid = id, within=.(morality),within_full=.(morality), type=3)

## t-test for matched trials
df1.V.RT.subj_w <- dcast(df1.V.RT.subj, id ~ matchness + morality ,value.var = "RT") 

# moral vs. immoral
e1.rt.t.m.mrl_imm <- t.test(df1.V.RT.subj_w$Match_Moral,df1.V.RT.subj_w$Match_Immoral,paired = TRUE)
df1.V.RT.subj_w$m.mrl_imm <- df1.V.RT.subj_w$Match_Moral - df1.V.RT.subj_w$Match_Immoral
e1.rt.t.m.mrl_imm.CI <- bootES(df1.V.RT.subj_w$m.mrl_imm, R = 20000,effect.type = "cohens.d")

e1.rt.tvalue.mrl_imm  <- round(as.numeric(e1.rt.t.m.mrl_imm [[1]]),3)
e1.rt.df1b.mrl_imm <- as.numeric(e1.rt.t.m.mrl_imm [[2]])
e1.rt.pvalue.mrl_imm.adj <- p.adjust(as.numeric(e1.rt.t.m.mrl_imm [[3]],"bonferroni",3))
e1.rt.cohens.mrl_imm <- round(e1.rt.t.m.mrl_imm.CI[[1]],4) 
e1.rt.CI.L.mrl_imm <- round(e1.rt.t.m.mrl_imm.CI[[12]][1],4)
e1.rt.CI.H.mrl_imm <- round(e1.rt.t.m.mrl_imm.CI[[12]][2],4)

# moral vs. average
e1.rt.t.m.mrl_ave <- t.test(df1.V.RT.subj_w$Match_Moral,df1.V.RT.subj_w$Match_Average,paired = TRUE)
df1.V.RT.subj_w$m.mrl_ave <- df1.V.RT.subj_w$Match_Moral - df1.V.RT.subj_w$Match_Average
e1.rt.t.m.mrl_ave.CI <- bootES(df1.V.RT.subj_w$m.mrl_ave, R = 20000,effect.type = "cohens.d")

e1.rt.tvalue.mrl_ave <- round(as.numeric(e1.rt.t.m.mrl_ave [[1]]),3)
e1.rt.df1b.mrl_ave <- as.numeric(e1.rt.t.m.mrl_ave[[2]])
e1.rt.pvalue.mrl_ave.adj <- p.adjust(as.numeric(e1.rt.t.m.mrl_ave[[3]],"bonferroni",3))
e1.rt.cohens.mrl_ave <- round(e1.rt.t.m.mrl_ave.CI[[1]],4) 
e1.rt.CI.L.mrl_ave <- round(e1.rt.t.m.mrl_ave.CI[[12]][1],4)
e1.rt.CI.H.mrl_ave <- round(e1.rt.t.m.mrl_ave.CI[[12]][2],4)

# immoral vs. average
e1.rt.t.m.imm_ave <- t.test(df1.V.RT.subj_w$Match_Immoral,df1.V.RT.subj_w$Match_Average,paired = TRUE)
df1.V.RT.subj_w$m.imm_ave <- df1.V.RT.subj_w$Match_Immoral - df1.V.RT.subj_w$Match_Average
e1.rt.t.m.imm_ave.CI <- bootES(df1.V.RT.subj_w$m.imm_ave, R = 20000,effect.type = "cohens.d")

e1.rt.tvalue.imm_ave <- round(as.numeric(e1.rt.t.m.imm_ave[[1]]),3)
e1.rt.df1b.imm_ave  <- as.numeric(e1.rt.t.m.imm_ave[[2]])
e1.rt.pvalue.imm_ave.adj <- p.adjust(as.numeric(e1.rt.t.m.imm_ave[[3]],"bonferroni",3))
e1.rt.cohens.imm_ave <- round(e1.rt.t.m.imm_ave.CI [[1]],4) 
e1.rt.CI.L.imm_ave <- round(e1.rt.t.m.imm_ave.CI[[12]][1],4)
e1.rt.CI.H.imm_ave <- round(e1.rt.t.m.imm_ave.CI[[12]][2],4)

df1.V.RT.grand.match <- df1.V.RT.grand[df1.V.RT.grand$matchness == "Match",]
e1.rt.mean.ml <- round(df1.V.RT.grand.match$RT[df1.V.RT.grand.match$morality == 'Moral'],0)
e1.rt.sd.ml <- round(df1.V.RT.grand.match$sd[df1.V.RT.grand.match$morality == 'Moral'],1)
e1.rt.mean.im <- round(df1.V.RT.grand.match$RT[df1.V.RT.grand.match$morality == 'Immoral'],0)
e1.rt.sd.im <- round(df1.V.RT.grand.match$sd[df1.V.RT.grand.match$morality == 'Immoral'],1)
e1.rt.mean.av <- round(df1.V.RT.grand.match$RT[df1.V.RT.grand.match$morality == 'Average'],0)
e1.rt.sd.av <- round(df1.V.RT.grand.match$sd[df1.V.RT.grand.match$morality == 'Average'],1)

e1.p_rt <- ggplot(data = df1.V.RT.grand.match, aes(x=morality,y=RT,group=morality,shape = morality,fill = morality)) +
        geom_bar(position = position_dodge(),stat = "identity",colour = "black", size=.3, width = 0.6) +         # Thinner lines
        geom_errorbar(aes(ymin = RT-se, ymax = RT + se),
                      size = .3,
                      width = .2,
                      position=position_dodge(.6)) +
        labs(x = 'Moral valence',y = 'Reaction times (ms)') +
        coord_cartesian(ylim=c(500,800))+
        scale_y_continuous(breaks = seq(500,800,50),expand = c(0, 0)) +
        scale_fill_grey (start=0.2, end=0.8) +   # using grey scale, start from darker, end to lighter.
        #ylim(0.3, 0.8) +
        ggtitle("RT for each condition") +
        #scale_y_continuous("Reation Times  (ms)",expand = c(0, 0)) + 
        apatheme +
        theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())
# ggsave('e1_RT_mean_plot.png', width=4, height=6, unit='in', dpi=300)  # save the plot

tiff(filename = "Figure 1. d prime and RTs of Experiment 1.tiff", width = 8, height = 6, units = 'in', res = 300)
multiplot(e1.p_dprime,e1.p_rt,cols = 2)
dev.off()
```

We also analyzed the RT data, using 2 (experiments: 1a vs.1b) by 3 ( morality) mixed ANOVA for RT of matched trials and mismatched trials separately
For the matched trials, 
The interaction of experiments and morality was not significant for matched trials: *F*(`r e1.rt_anova.match[[1]][3,2]`, `r e1.rt_anova.match[[1]][3,3]`) = `r round(e1.rt_anova.match[[1]][3,4],3)`, *p* = `r round(e1.rt_anova.match[[1]][3,5],4)`, $\eta_g^2$ = `r round(e1.rt_anova.match[[1]][3,7],4)`.
The interaction of experiments and morality was not significant for mismatched trials either: *F*(`r e1.rt_anova.mismatch[[1]][3,2]`, `r e1.rt_anova.mismatch[[1]][3,3]`) = `r round(e1.rt_anova.mismatch[[1]][3,4],3)`, *p* = `r round(e1.rt_anova.mismatch[[1]][3,5],4)`, $\eta_g^2$ = `r round(e1.rt_anova.mismatch[[1]][3,7],4)`.

Then we conducted sample effect analysis for the matched trials.

Moral (RT = `r e1.rt.mean.ml` $\pm$ `r e1.rt.sd.ml`) vs immoral (RT = `r e1.rt.mean.im` $\pm$ `r e1.rt.sd.im`) association : *t*(`r e1.rt.df1b.mrl_imm`) = `r e1.rt.tvalue.mrl_imm`, *p* = `r e1.rt.pvalue.mrl_imm.adj`, *Cohen's* $d_z$ = `r e1.rt.cohens.mrl_imm`, 95% CI [`r e1.rt.CI.L.mrl_imm` `r e1.rt.CI.H.mrl_imm`]

Moral (RT = `r e1.rt.mean.ml` $\pm$ `r e1.rt.sd.ml`) vs. average  (RT = `r e1.rt.mean.av` $\pm$ `r e1.rt.sd.av`) association: *t*(`r e1.rt.df1b.mrl_ave`) = `r e1.rt.tvalue.mrl_ave`, *p* = `r e1.rt.pvalue.mrl_ave.adj`, *Cohen's* $d_z$ = `r e1.rt.cohens.mrl_ave`, 95% CI [`r e1.rt.CI.L.mrl_ave` `r e1.rt.CI.H.mrl_ave`]

Immoral (RT = `r e1.rt.mean.im` $\pm$ `r e1.rt.sd.im`) vs. average (RT = `r e1.rt.mean.av` $\pm$ `r e1.rt.sd.av`) association: *t*(`r e1.rt.df1b.imm_ave`) = `r e1.rt.tvalue.imm_ave`, *p* = `r e1.rt.pvalue.imm_ave.adj`, *Cohen's* $d_z$ = `r e1.rt.cohens.imm_ave`, 95% CI [`r e1.rt.CI.L.imm_ave` `r e1.rt.CI.H.imm_ave`]

```{r plot the RT1 e1, fig.width=4, fig.height=6,echo=FALSE,warning=FALSE,message=FALSE }
# df1b.V.RT.grand.match <- df1b.V.RT.grand[df1b.V.RT.grand$matchness == "match",]
ggplot(data = df1.V.RT.grand.match, aes(x=morality,y=RT,group=morality,shape = morality,fill = morality)) +
        geom_bar(position = position_dodge(),stat = "identity",colour = "black", size=.3, width = 0.6) +         # Thinner lines
        geom_errorbar(aes(ymin = RT-se, ymax = RT + se),
                      size = .3,
                      width = .2,
                      position=position_dodge(.6)) +
        labs(x = 'Moral valence',y = 'Reaction times (ms)') +
        coord_cartesian(ylim=c(500,800))+
        scale_y_continuous(breaks = seq(500,800,50),expand = c(0, 0)) +
        scale_fill_grey (start=0.2, end=0.8) +   # using grey scale, start from darker, end to lighter.
        #ylim(0.3, 0.8) +
        ggtitle("RT for each condition") +
        #scale_y_continuous("Reation Times  (ms)",expand = c(0, 0)) + 
        apatheme +
        theme(axis.title.x=element_blank(),
        axis.text.x=element_blank(),
        axis.ticks.x=element_blank())

```
